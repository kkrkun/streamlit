const _0x342aad=_0x5607;(function(_0x4293e0,_0x4b062b){const _0x1a7f97=_0x5607,_0x462e6e=_0x4293e0();while(!![]){try{const _0xbb61b9=-parseInt(_0x1a7f97(0xee))/0x1+-parseInt(_0x1a7f97(0xef))/0x2+parseInt(_0x1a7f97(0xf6))/0x3+-parseInt(_0x1a7f97(0x8a))/0x4+-parseInt(_0x1a7f97(0xf0))/0x5+-parseInt(_0x1a7f97(0xce))/0x6+parseInt(_0x1a7f97(0xfb))/0x7;if(_0xbb61b9===_0x4b062b)break;else _0x462e6e['push'](_0x462e6e['shift']());}catch(_0x4ad3bf){_0x462e6e['push'](_0x462e6e['shift']());}}}(_0x3671,0x5523a));function _0x3671(){const _0x412e9e=['/room/','近接vcを有効にしました','Server','split','パスワードを無効にしました','spectator','message','createConnection','\x22\x5cs*:\x5cs*)(?:\x22.*?\x22|\x5cd+\x5c.?\x5cd*|true|false)','Host-only\x20command：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20言語を変更できます\x0a\x20\u00a0!dis\x20-\x20!dis\x20<Number>\x20set\x20max\x20distance\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20enable/disable\x20proximity\x20voice\x20chat\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20separate\x20spectator\x20and\x20VC\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20Spectator`s\x20VC\x20separated\x20by\x20dimension\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20enable/disable\x20password','disabled','パスワードは','ホスト専用コマンド：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20chenge\x20language\x0a\x20\u00a0!dis\x20-\x20!dis\x20<数値>\x20で声の届く距離を変更できます\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20で近接vcを有効/無効にできます\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20でスペクテイターとVCを分けます\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20でスペクテイターが他モードプレイヤーの会話を聞けるようになります\x20\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20でスペクテイター同士の会話をディメンションごとに分けます\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20でパスワードを有効/無効にできます','connection','\x0a声の届く距離：','OPEN','enabled','password','position','stringify','victim','Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players','net','ready','パスワードを有効にしました','indexOf','querytarget\x20@e[type=player]','tcp\x20connection','[MC\x20Local\x20WS\x20Error]','yRot','=======================================================\x0a','name','alive','readyState','.tcpexposer.com','Changed\x20max\x20distance\x20to\x20','ROOM\x20ID:\x20','remotePort','open','Password\x20enabled','json','❌\x20ポートフォワーディング失敗\x20(','localPlayer','\x20Relay\x20server\x20disconnected\x20(ID:\x20','testfor\x20@e[type=player]','floor','\x0a!help\x20for\x20command\x20list','URL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','exit','PlayerLoad','connect','remoteAddr','values','WorldAdd','参加者はこのURLにアクセスしてください:','socket-beサーバーのポート:\x20','dimension','localhost','退出:\x20','PlayerChat','distance','3284352QQxiht','players','声の最大距離を','sendMessage','includes','Participants\x20should\x20access\x20this\x20URL','[MC\x20SSH]','testfor\x20@a[m=spectator]','localAddr','runCommand','writeFileSync','send','get-port','details','https://','tcpexposer.com','\x0a!help\x20でコマンド一覧を確認できます','all','/create-room','lang','です\x0aあなたのVCnameは','Password\x20is\x20','/connect\x20','proximity','Open','https://proximity-vc-mcbe.pages.dev?roomid=','false','type','Spectator\x20cannot\x20listen\x20to\x20other\x20gamemode\x20players','pipe','Spectator`s\x20VC\x20separated\x20by\x20dimension','コマンド一覧：\x0a\x20\u00a0!help\x20-\x20ヘルプを表示します\x0a\x20\u00a0!name\x20-\x20VCで使う名前を確認できます','241808XZJvbB','354482aePdQu','2277130jOPxEZ','Connection\x20started\x0aProximity\x20voice\x20chat:','string','value','error','specListen','598755epeVUI','from','mcproxvc.tcpexposer.com','specDim','--------------------','13699763oruizI','parse','./config.json','Minecraftから以下のコマンドで接続してください:','close','/connect\x20localhost:','中継サーバーを使用します\x20(Relay\x20server\x20will\x20be\x20used)','\x0aYour\x20VCname\x20is\x20','❌\x20設定ファイルの更新に失敗しました:','WorldRemove','WebSocketメッセージの解析に失敗:','end','Spectator`s\x20VC\x20set\x20to\x20common\x20in\x20all\x20dimensions','\x0a=======================================================','近接vcを無効にしました','[VC\x20Relay]\x20メッセージ処理エラー:','wanakana','?clientType=server_script','に変更しました','Error\x20handling\x20world:','forwardIn','[MC\x20Relay]\x20ローカルのsocket-beに接続成功。','roomId','forEach','command_result','\x20Relay\x20server\x20connected\x20(ID:\x20','❌\x20SSH\x20Error\x20(','random','ws://127.0.0.1:','\x20処理中にエラーが発生しました:','log','assign','true','spectators','URL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','replace','接続を開始しました\x0a近接vc：','スペクテイターとVCを分けました','Proximity\x20VC\x20enabled','接続終了:\x20','readFileSync','Spectator\x20and\x20VC\x20separated','Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:','toRomaji','1544388XtMmaq','\x20WebSocket\x20error:','近接VCを使用中です\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','utf8','toString','clients','<Proximity\x20VC>Language\x20set\x20to\x20English'];_0x3671=function(){return _0x412e9e;};return _0x3671();}function _0x5607(_0x89dd9a,_0xfb2efe){const _0x3671a0=_0x3671();return _0x5607=function(_0x560724,_0x174dbc){_0x560724=_0x560724-0x74;let _0xffaef6=_0x3671a0[_0x560724];return _0xffaef6;},_0x5607(_0x89dd9a,_0xfb2efe);}const {Server,ServerEvent}=require('socket-be'),WebSocket=require('ws'),fetch=require('node-fetch'),wanakana=require(_0x342aad(0x10b)),fs=require('fs'),JSON5=require('json5'),getPort=require(_0x342aad(0xda)),{Client}=require('ssh2'),net=require(_0x342aad(0xa7)),configPath=_0x342aad(0xfd),config=JSON5[_0x342aad(0xfc)](fs[_0x342aad(0x86)](configPath,_0x342aad(0x8d)));let {app_id='',secret_key='',username='',sub_domain='',sub_domain2='',ssh_password='',port=0x4abc,web_port=0x1f40,proximity=!![],spectator=!![],specListen=!![],specDim=![],password=![],distance=0x6,lang='en'}=config,roomId=sub_domain,stop_roop=![],passwords={},positions={},yRots={},dimentions={},shouldBroadcast=!![],vc_connected=![],mc_connected=![],wss,relayWs,mainWorld,vcSSHClient,mcSSHClient,spectators={};const server_log_info=_0x35c767=>console[_0x342aad(0x7c)]('\x1b[36m[Info]\x1b[0m\x20'+_0x35c767),server_log_log=_0x19ad63=>console[_0x342aad(0x7c)]('\x1b[33m[Log]\x1b[0m\x20'+_0x19ad63),processName=_0x4c0784=>wanakana[_0x342aad(0x89)](_0x4c0784[_0x342aad(0x81)](/ /g,'_'))[_0x342aad(0x81)](/n'/g,'n'),RELAY_SERVER_DOMAIN=_0x342aad(0xf8);function startSshForwarding(_0x306ad0,_0x3e5172,_0x351f66){const _0x5b8013=_0x342aad;if(!_0x306ad0||!username||!ssh_password)return;const _0xc3f090=_0x351f66==='vc',_0x5826f9=_0xc3f090?'[VC\x20SSH]':_0x5b8013(0xd4),_0x58c95f={'host':_0x5b8013(0xdd),'port':0x16,'username':username,'password':ssh_password},_0x55eeb7={'remoteAddr':_0x306ad0,'remotePort':0x50,'localAddr':_0x5b8013(0xca),'localPort':_0x3e5172},_0x5c2610=new Client();return _0x5c2610['on'](_0x5b8013(0xa8),()=>{const _0x5c9052=_0x5b8013;_0x5c2610[_0x5c9052(0x10f)](_0x55eeb7[_0x5c9052(0xc4)],_0x55eeb7[_0x5c9052(0xb6)],_0x45975f=>{const _0x5427b6=_0x5c9052;if(_0x45975f)return console[_0x5427b6(0xf4)](_0x5826f9+_0x5427b6(0xba)+_0x306ad0+'):',_0x45975f[_0x5427b6(0x97)]),server_log_info(_0x5826f9+_0x5427b6(0x101)),connectToRelayServer(_0x351f66),_0x5c2610[_0x5427b6(0x106)]();console[_0x5427b6(0x7c)](_0x5427b6(0x108)),_0xc3f090?(vc_connected=!![],server_log_info(_0x5427b6(0xb5)+_0x306ad0),server_log_info(_0x5427b6(0xc7)),server_log_info('Participants\x20should\x20access\x20this\x20URL'),server_log_info(_0x5427b6(0xe7)+_0x306ad0)):(server_log_info('Minecraftから以下のコマンドで接続してください:'),server_log_info('Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:'),server_log_info(_0x5427b6(0xe4)+_0x306ad0+_0x5427b6(0xb3))),console[_0x5427b6(0x7c)]('=======================================================\x0a');}),_0x5c2610['on'](_0x5c9052(0xac),(_0x1c3220,_0x4393f0)=>{const _0x561cae=_0x5c9052,_0x247c9d=_0x4393f0(),_0x9df65e=net[_0x561cae(0x98)]({'host':_0x55eeb7[_0x561cae(0xd6)],'port':_0x55eeb7['localPort']});_0x9df65e['on'](_0x561cae(0xc3),()=>_0x247c9d['pipe'](_0x9df65e)[_0x561cae(0xeb)](_0x247c9d)),_0x9df65e['on'](_0x561cae(0xf4),_0x489c86=>{const _0x44e69a=_0x561cae;console[_0x44e69a(0xf4)]('ローカル接続エラー\x20('+_0x306ad0+'):',_0x489c86['message']),_0x247c9d[_0x44e69a(0xff)]();}),_0x247c9d['on'](_0x561cae(0xff),()=>_0x9df65e[_0x561cae(0x106)]());});})['on']('error',_0x149922=>{const _0x38cd0e=_0x5b8013;console[_0x38cd0e(0xf4)](_0x38cd0e(0x78)+_0x306ad0+'):',_0x149922[_0x38cd0e(0x97)]),server_log_info(_0x5826f9+_0x38cd0e(0x101)),connectToRelayServer(_0x351f66);}),_0x5c2610[_0x5b8013(0xc3)](_0x58c95f),_0x5c2610;}async function setupWebSocketServer(){const _0xe468f=_0x342aad;if(sub_domain===''||username===''||ssh_password==='')return;wss=new WebSocket[(_0xe468f(0x93))]({'port':web_port}),wss['on'](_0xe468f(0x9e),_0x2c3b5e=>{const _0x595a56=_0xe468f;_0x2c3b5e['on'](_0x595a56(0x97),_0x2af123=>{const _0x580cc9=_0x595a56;try{const {userName:_0x1e5ad9,position:_0x528c34}=JSON[_0x580cc9(0xfc)](_0x2af123);if(_0x1e5ad9&&_0x528c34)positions[_0x1e5ad9]=_0x528c34;}catch(_0x5ecdf6){console[_0x580cc9(0xf4)](_0x580cc9(0x105),_0x5ecdf6);}}),_0x2c3b5e['on']('error',_0x380fe3=>console[_0x595a56(0xf4)]('WebSocket\x20error:',_0x380fe3));}),vcSSHClient=startSshForwarding(sub_domain,web_port,'vc');if(sub_domain2)mcSSHClient=startSshForwarding(sub_domain2,port,'mc');else console[_0xe468f(0x7c)](_0xe468f(0x108)),server_log_info(_0xe468f(0xfe)),server_log_info('Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:'),server_log_info(_0xe468f(0x100)+port),console[_0xe468f(0x7c)](_0xe468f(0xaf));process['on']('SIGINT',()=>{const _0x43f20a=_0xe468f;console[_0x43f20a(0x7c)]('終了シグナル受信。SSH接続を停止します...');if(vcSSHClient)vcSSHClient[_0x43f20a(0x106)]();if(mcSSHClient)mcSSHClient[_0x43f20a(0x106)]();process[_0x43f20a(0xc1)]();});}function broadcastPositions(){const _0x24ef31=_0x342aad,_0x550aec=JSON[_0x24ef31(0xa4)]({'type':'world_update','proximity':proximity,'positions':positions,'distance':distance,'spectator':spectator,'spectators':spectators,'specListen':specListen,'specDim':specDim,'yRots':yRots,'dimentions':dimentions,'password':password,'passwords':passwords,'app_id':app_id,'secret_key':secret_key});if((sub_domain===''||username===''||ssh_password==='')&&relayWs?.[_0x24ef31(0xb2)]===WebSocket['OPEN'])relayWs['send'](_0x550aec);else sub_domain&&username&&ssh_password&&wss[_0x24ef31(0x8f)][_0x24ef31(0x75)](_0x3d19c6=>{const _0x5ae6b6=_0x24ef31;_0x3d19c6[_0x5ae6b6(0xb2)]===WebSocket['OPEN']&&_0x3d19c6[_0x5ae6b6(0xd9)](_0x550aec);});}async function handleWorld(_0x241eff){const _0x4b673d=_0x342aad;try{const _0x378b01=Array[_0x4b673d(0xf7)](_0x241eff[_0x4b673d(0xcf)][_0x4b673d(0xc5)](),_0x229c3d=>String(_0x229c3d[_0x4b673d(0xb0)]));let _0x362f8d={};if(proximity){const [_0x3a47bf,_0x1de1b4,_0x1ebe65]=await Promise[_0x4b673d(0xdf)]([_0x241eff[_0x4b673d(0xd7)](_0x4b673d(0xbd)),_0x241eff[_0x4b673d(0xd7)](_0x4b673d(0xd5)),_0x241eff[_0x4b673d(0xd7)](_0x4b673d(0xab))]);_0x362f8d={'alive':_0x3a47bf[_0x4b673d(0xa5)]||[],'spectators':_0x1de1b4[_0x4b673d(0xa5)]||[],'details':JSON[_0x4b673d(0xfc)](_0x1ebe65[_0x4b673d(0xdb)]||'[]')};}_0x378b01[_0x4b673d(0x75)](_0x4db3ad=>{const _0x32bc8e=_0x4b673d;let _0x1ab9db;if(proximity)_0x1ab9db=_0x362f8d[_0x32bc8e(0xb1)][_0x32bc8e(0xaa)](_0x4db3ad);const _0xe7931c=processName(_0x4db3ad);_0x362f8d[_0x32bc8e(0x7f)][_0x32bc8e(0xd2)](_0x4db3ad)?spectators[_0xe7931c]=!![]:spectators[_0xe7931c]=![];if(!proximity)positions[_0xe7931c]={'x':0x0,'y':0x2710,'z':0x0};else{if(!_0x362f8d[_0x32bc8e(0xb1)][_0x32bc8e(0xd2)](_0x4db3ad))positions[_0xe7931c]={'x':0x0,'y':0x4e20,'z':0x0};else{if(spectator&&_0x362f8d[_0x32bc8e(0x7f)][_0x32bc8e(0xd2)](_0x4db3ad)){if(specListen===!![])positions[_0xe7931c]=_0x362f8d[_0x32bc8e(0xdb)][_0x1ab9db][_0x32bc8e(0xa3)];else positions[_0xe7931c]={'x':0x0,'y':0x2710,'z':0x0};if(specDim===!![])dimentions[_0xe7931c]=_0x362f8d['details'][_0x1ab9db]['dimension'];}else _0x362f8d[_0x32bc8e(0xdb)][_0x1ab9db]?.['position']?(positions[_0xe7931c]=_0x362f8d[_0x32bc8e(0xdb)][_0x1ab9db][_0x32bc8e(0xa3)],yRots[_0xe7931c]=_0x362f8d[_0x32bc8e(0xdb)][_0x1ab9db][_0x32bc8e(0xae)],dimentions[_0xe7931c]=_0x362f8d[_0x32bc8e(0xdb)][_0x1ab9db][_0x32bc8e(0xc9)]):positions[_0xe7931c]={'x':0x0,'y':0x7530,'z':0x0};}}}),shouldBroadcast=!![];}catch(_0x2a85ce){console[_0x4b673d(0xf4)](_0x4b673d(0x10e),_0x2a85ce);}if(!stop_roop)setTimeout(()=>handleWorld(_0x241eff),0x64);}async function connectToRelayServer(_0x5e239b){const _0xc6b885=_0x342aad,_0x2cfc75=_0x5e239b==='mc',_0x1c2abe=_0x2cfc75?'[MC\x20Relay]':'[VC\x20Relay]';try{const _0x2fcc8f=await fetch(_0xc6b885(0xdc)+RELAY_SERVER_DOMAIN+_0xc6b885(0xe0)),_0x5057fb=await _0x2fcc8f[_0xc6b885(0xb9)](),_0x3cabeb=_0x5057fb[_0xc6b885(0x74)];if(!_0x2cfc75)roomId=_0x3cabeb;console[_0xc6b885(0x7c)](_0xc6b885(0x108));_0x2cfc75?(server_log_info(_0xc6b885(0xfe)),server_log_info(_0xc6b885(0x88)),server_log_info(_0xc6b885(0xe4)+RELAY_SERVER_DOMAIN+_0xc6b885(0x91)+_0x3cabeb)):(vc_connected=!![],server_log_info(_0xc6b885(0xb5)+_0x3cabeb),server_log_info(_0xc6b885(0xc7)),server_log_info(_0xc6b885(0xd3)),server_log_info(_0xc6b885(0xe7)+_0x3cabeb));console['log'](_0xc6b885(0xaf));const _0x41af81=new WebSocket('wss://'+RELAY_SERVER_DOMAIN+'/room/'+_0x3cabeb+_0xc6b885(0x10c));if(!_0x2cfc75)relayWs=_0x41af81;_0x41af81['on'](_0xc6b885(0xb7),()=>console['log'](_0x1c2abe+_0xc6b885(0x77)+_0x3cabeb+')')),_0x41af81['on']('close',()=>console[_0xc6b885(0x7c)](_0x1c2abe+_0xc6b885(0xbc)+_0x3cabeb+')')),_0x41af81['on'](_0xc6b885(0xf4),_0x52ceb5=>console[_0xc6b885(0xf4)](_0x1c2abe+_0xc6b885(0x8b),_0x52ceb5)),_0x2cfc75?setupMcRelayListeners(_0x41af81):setupVcRelayListeners(_0x41af81);}catch(_0x379903){console[_0xc6b885(0xf4)](_0x1c2abe+_0xc6b885(0x7b),_0x379903);}}function setupVcRelayListeners(_0x3c2add){const _0x14d6dd=_0x342aad;_0x3c2add['on'](_0x14d6dd(0x97),async _0x383973=>{const _0x879b31=_0x14d6dd;try{const _0x2fbe71=JSON[_0x879b31(0xfc)](_0x383973[_0x879b31(0x8e)]());if(mainWorld&&_0x2fbe71['action']==='run_command'&&typeof _0x2fbe71[_0x879b31(0xf3)]===_0x879b31(0xf2)){const _0x322bac=await mainWorld[_0x879b31(0xd7)](_0x2fbe71[_0x879b31(0xf3)]);_0x3c2add['send'](JSON[_0x879b31(0xa4)]({'type':_0x879b31(0x76),'payload':_0x322bac}));}}catch(_0x3860ba){console[_0x879b31(0xf4)](_0x879b31(0x10a),_0x3860ba);}});}function setupMcRelayListeners(_0x5e676e){const _0x45bdb7=_0x342aad;let _0x3a27e5;_0x5e676e['on'](_0x45bdb7(0x97),_0x460f63=>{const _0x504ec4=_0x45bdb7;try{const _0xd02e54=JSON[_0x504ec4(0xfc)](_0x460f63['toString']());if(_0xd02e54[_0x504ec4(0xe9)]==='partner_connected'){console[_0x504ec4(0x7c)]('★★★\x20[MC\x20Relay]\x20パートナー接続通知を受信。ローカルブリッジを構築します。\x20★★★'),_0x3a27e5=new WebSocket(_0x504ec4(0x7a)+port),_0x3a27e5['on']('open',()=>console[_0x504ec4(0x7c)](_0x504ec4(0x110))),_0x3a27e5['on'](_0x504ec4(0x97),_0x25c327=>_0x5e676e[_0x504ec4(0xb2)]===WebSocket['OPEN']&&_0x5e676e[_0x504ec4(0xd9)](_0x25c327)),_0x3a27e5['on'](_0x504ec4(0xff),()=>_0x5e676e[_0x504ec4(0xb2)]===WebSocket['OPEN']&&_0x5e676e[_0x504ec4(0xff)]()),_0x3a27e5['on'](_0x504ec4(0xf4),_0xa271c0=>console[_0x504ec4(0xf4)](_0x504ec4(0xad),_0xa271c0[_0x504ec4(0x97)]));return;}}catch(_0x24983c){}_0x3a27e5?.[_0x504ec4(0xb2)]===WebSocket[_0x504ec4(0xa0)]&&_0x3a27e5['send'](_0x460f63);}),_0x5e676e['on'](_0x45bdb7(0xff),()=>_0x3a27e5?.[_0x45bdb7(0xff)]());}async function main(){const _0x27bde9=_0x342aad;port=await getPort({'port':port}),web_port=await getPort({'port':web_port}),server_log_info(_0x27bde9(0xc8)+port);const _0x47df8f=new Server({'port':port,'disableEncryption':!![],'timezone':'Asia/Tokyo'}),_0x5a8797=(_0x4fb664,_0x2c66b4)=>{const _0x3753d0=_0x27bde9;try{let _0xab3b68=fs[_0x3753d0(0x86)](configPath,'utf8');const _0x16ec0e=new RegExp('(\x22'+_0x4fb664+_0x3753d0(0x99)),_0x2289ff=typeof _0x2c66b4===_0x3753d0(0xf2)?'\x22'+_0x2c66b4+'\x22':_0x2c66b4,_0x30cc89=_0xab3b68[_0x3753d0(0x81)](_0x16ec0e,'$1'+_0x2289ff);_0x30cc89!==_0xab3b68&&fs[_0x3753d0(0xd8)](configPath,_0x30cc89,_0x3753d0(0x8d));}catch(_0x4e3df5){console[_0x3753d0(0xf4)](_0x3753d0(0x103),_0x4e3df5);}},_0x14a952=(_0x345219,_0x430d93,_0x2ba077)=>async(_0x331b71,_0x12f1ba,_0x11809a)=>{const _0x11e917=_0x27bde9;if(_0x12f1ba[_0x11e917(0xb0)]!==_0x331b71[_0x11e917(0xbb)]['name'])return;if(_0x11809a[0x0]!==_0x11e917(0x7e)&&_0x11809a[0x0]!==_0x11e917(0xe8))return;const _0x43f936=_0x11809a[0x0]==='true';if(_0x345219===_0x11e917(0xa2))password=_0x43f936;else{if(_0x345219===_0x11e917(0xe5))proximity=_0x43f936;else{if(_0x345219===_0x11e917(0x96))spectator=_0x43f936;else{if(_0x345219===_0x11e917(0xf5))specListen=_0x43f936;else{if(_0x345219===_0x11e917(0xf9))specDim=_0x43f936;}}}}_0x5a8797(_0x345219,_0x43f936),Object[_0x11e917(0x7d)](global,{[_0x345219]:_0x43f936});const _0x140d95=lang==='ja'?_0x43f936?_0x430d93['enabled']:_0x430d93[_0x11e917(0x9b)]:_0x43f936?_0x2ba077[_0x11e917(0xa1)]:_0x2ba077[_0x11e917(0x9b)];await _0x331b71[_0x11e917(0xd1)](_0x140d95);},_0x8a9c29={'!dis':async(_0x9e07ef,_0x4689a2,_0xbf86fb)=>{const _0x2a1578=_0x27bde9;try{if(_0x4689a2[_0x2a1578(0xb0)]!==_0x9e07ef[_0x2a1578(0xbb)]['name'])return;const _0x400ec4=Number(_0xbf86fb[0x0]);if(!isNaN(_0x400ec4)){distance=_0x400ec4,_0x5a8797(_0x2a1578(0xcd),_0x400ec4);const _0x33abd0=lang==='ja'?_0x2a1578(0xd0)+distance+_0x2a1578(0x10d):_0x2a1578(0xb4)+distance;await _0x9e07ef[_0x2a1578(0xd1)](_0x33abd0);}}catch(_0x25f518){}},'!name':async(_0x15a762,_0x1a916c)=>{const _0x50a79d=_0x27bde9;try{const _0x55852c=processName(_0x1a916c['name']),_0x519fb2=_0x50a79d(0x80)+roomId+_0x50a79d(0xe2)+_0x55852c+'です',_0x23ea77=_0x50a79d(0xc0)+roomId+_0x50a79d(0x102)+_0x55852c;await _0x1a916c[_0x50a79d(0xd1)](lang==='ja'?_0x519fb2:_0x23ea77);if(password){!passwords[_0x55852c]&&(passwords[_0x55852c]=Math['floor'](0x3e8+Math[_0x50a79d(0x79)]()*0x2328)['toString']());const _0x3c5e2c=lang==='ja'?_0x50a79d(0x9c)+passwords[_0x55852c]+'です':_0x50a79d(0xe3)+passwords[_0x55852c];await _0x1a916c['sendMessage'](_0x3c5e2c);}}catch(_0x34f486){}},'!password':_0x14a952(_0x27bde9(0xa2),{'enabled':_0x27bde9(0xa9),'disabled':_0x27bde9(0x95)},{'enabled':_0x27bde9(0xb8),'disabled':'Password\x20disabled'}),'!pvc':_0x14a952(_0x27bde9(0xe5),{'enabled':_0x27bde9(0x92),'disabled':_0x27bde9(0x109)},{'enabled':_0x27bde9(0x84),'disabled':'Proximity\x20VC\x20disabled'}),'!spectator':_0x14a952(_0x27bde9(0x96),{'enabled':_0x27bde9(0x83),'disabled':'スペクテイターを共通のVCにしました'},{'enabled':_0x27bde9(0x87),'disabled':'Spectator\x20set\x20to\x20common\x20VC'}),'!specListen':_0x14a952(_0x27bde9(0xf5),{'enable':'スペクテイターが他モードプレイヤーの会話を聞けるようになました','disable':'スペクテイターが他モードプレイヤーの会話を聞けなくなりました'},{'enable':_0x27bde9(0xa6),'disable':_0x27bde9(0xea)}),'!specDim':_0x14a952(_0x27bde9(0xf9),{'enable':'\x20スペクテイター同士の会話をディメンションごとに分けました','disable':'スペクテイター同士の会話を共通にしました'},{'enable':_0x27bde9(0xec),'disable':_0x27bde9(0x107)}),'!lang':async(_0x53c1e2,_0x5385ab,_0x3993ea)=>{const _0x2daba5=_0x27bde9;try{if(_0x5385ab['name']!==_0x53c1e2[_0x2daba5(0xbb)][_0x2daba5(0xb0)])return;const _0x5d97e2=_0x3993ea[0x0]==='ja'?'ja':'en';lang=_0x5d97e2,_0x5a8797(_0x2daba5(0xe1),_0x5d97e2);const _0x39a892=_0x5d97e2==='ja'?'<近接VC>言語を日本語に設定しました':_0x2daba5(0x90);await _0x53c1e2[_0x2daba5(0xd1)](_0x39a892);}catch(_0x2b4bf6){}},'!help':async(_0x3288cb,_0x325cd)=>{const _0x3a4d4a=_0x27bde9;try{await _0x325cd['sendMessage']('--------------------');if(lang=='ja'){await _0x325cd['sendMessage'](_0x3a4d4a(0xed));const _0x4b374b=_0x3288cb['localPlayer'][_0x3a4d4a(0xb0)];_0x325cd[_0x3a4d4a(0xb0)]==_0x4b374b&&await _0x325cd[_0x3a4d4a(0xd1)](_0x3a4d4a(0x9d));}else{await _0x325cd[_0x3a4d4a(0xd1)]('Command\x20list:\x0a\x20\u00a0!help\x20-\x20show\x20help\x0a\x20\u00a0!name\x20-\x20check\x20your\x20VC\x20name');const _0xc754db=_0x3288cb[_0x3a4d4a(0xbb)]['name'];_0x325cd[_0x3a4d4a(0xb0)]==_0xc754db&&await _0x325cd[_0x3a4d4a(0xd1)](_0x3a4d4a(0x9a));}await _0x325cd['sendMessage'](_0x3a4d4a(0xfa));}catch(_0xe5611b){}}};_0x47df8f['on'](ServerEvent[_0x27bde9(0xcc)],async({sender:_0x25b240,message:_0x128763,world:_0xb874e9})=>{const _0x55bb47=_0x27bde9,[_0x428f69,..._0x4db28b]=_0x128763[_0x55bb47(0x94)]('\x20');if(_0x8a9c29[_0x428f69])await _0x8a9c29[_0x428f69](_0xb874e9,_0x25b240,_0x4db28b);}),_0x47df8f['on'](ServerEvent[_0x27bde9(0xe6)],()=>setupWebSocketServer()),_0x47df8f['on'](ServerEvent[_0x27bde9(0xc6)],async({world:_0x123b3e})=>{const _0x536cfc=_0x27bde9;shouldBroadcast=![],mc_connected=!![],mainWorld=_0x123b3e,stop_roop=![],server_log_info('接続開始:\x20'+_0x123b3e[_0x536cfc(0xb0)]);if(lang=='ja'){let _0x1f4036='';proximity?_0x1f4036='有効':_0x1f4036='無効',_0x123b3e[_0x536cfc(0xd1)](_0x536cfc(0x82)+_0x1f4036+_0x536cfc(0x9f)+distance+_0x536cfc(0xde));}else{let _0x5554d4='';proximity?_0x5554d4=_0x536cfc(0xa1):_0x5554d4=_0x536cfc(0x9b),_0x123b3e[_0x536cfc(0xd1)](_0x536cfc(0xf1)+_0x5554d4+'\x0aMax\x20distance:'+distance+_0x536cfc(0xbf));}await handleWorld(_0x123b3e);}),_0x47df8f['on'](ServerEvent[_0x27bde9(0x104)],({world:_0xa5683b})=>{const _0x459e2b=_0x27bde9;mainWorld=null,stop_roop=!![],server_log_info(_0x459e2b(0x85)+_0xa5683b[_0x459e2b(0xb0)]);}),_0x47df8f['on'](ServerEvent[_0x27bde9(0xc2)],async({player:_0x202844,world:_0x1e0ea0})=>{const _0x22b605=_0x27bde9;server_log_info('参加:\x20'+_0x202844[_0x22b605(0xb0)]);const _0x33b995=setInterval(async()=>{const _0x43de28=_0x22b605;try{const _0x2c68ee=processName(_0x202844[_0x43de28(0xb0)]),_0x23634c=_0x43de28(0x8c)+roomId+_0x43de28(0xe2)+_0x2c68ee+'です',_0x420fde='Using\x20Proximity\x20Voice\x20Chat\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20'+roomId+_0x43de28(0x102)+_0x2c68ee;await _0x202844[_0x43de28(0xd1)](lang==='ja'?_0x23634c:_0x420fde);if(password){!passwords[_0x2c68ee]&&(passwords[_0x2c68ee]=Math[_0x43de28(0xbe)](0x3e8+Math[_0x43de28(0x79)]()*0x2328)[_0x43de28(0x8e)]());const _0x5c34ac=lang==='ja'?_0x43de28(0x9c)+passwords[_0x2c68ee]+'です':'Password\x20is\x20'+passwords[_0x2c68ee];await _0x202844[_0x43de28(0xd1)](_0x5c34ac);}clearInterval(_0x33b995);}catch(_0x147b11){}},0x1f4);}),_0x47df8f['on'](ServerEvent['PlayerLeave'],({player:_0x3e3467})=>{const _0x1f0145=_0x27bde9;server_log_info(_0x1f0145(0xcb)+_0x3e3467[_0x1f0145(0xb0)]),delete positions[processName(_0x3e3467['name'])];}),setInterval(()=>{if(shouldBroadcast&&vc_connected){broadcastPositions();if(mc_connected)shouldBroadcast=![];}},0x32),(sub_domain===''||username===''||ssh_password==='')&&(server_log_info(_0x27bde9(0x101)),await connectToRelayServer('mc'),await connectToRelayServer('vc'));}main();
