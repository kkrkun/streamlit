const _0x1f0e26=_0x2e63;function _0x2e63(_0x179dbe,_0x2d8ed1){const _0x24ab82=_0x24ab();return _0x2e63=function(_0x2e63ba,_0x233d5c){_0x2e63ba=_0x2e63ba-0x1b5;let _0x3bf073=_0x24ab82[_0x2e63ba];return _0x3bf073;},_0x2e63(_0x179dbe,_0x2d8ed1);}(function(_0x323e08,_0x2854f7){const _0xbe6c09=_0x2e63,_0x2a4753=_0x323e08();while(!![]){try{const _0x4dbfe5=-parseInt(_0xbe6c09(0x1cd))/0x1+parseInt(_0xbe6c09(0x241))/0x2*(parseInt(_0xbe6c09(0x24b))/0x3)+-parseInt(_0xbe6c09(0x242))/0x4+parseInt(_0xbe6c09(0x1c8))/0x5*(-parseInt(_0xbe6c09(0x243))/0x6)+-parseInt(_0xbe6c09(0x1da))/0x7+parseInt(_0xbe6c09(0x1d0))/0x8*(parseInt(_0xbe6c09(0x254))/0x9)+parseInt(_0xbe6c09(0x207))/0xa*(parseInt(_0xbe6c09(0x206))/0xb);if(_0x4dbfe5===_0x2854f7)break;else _0x2a4753['push'](_0x2a4753['shift']());}catch(_0xb2d706){_0x2a4753['push'](_0x2a4753['shift']());}}}(_0x24ab,0x22153));const {Server,ServerEvent}=require('socket-be'),WebSocket=require('ws'),fetch=require('node-fetch'),wanakana=require(_0x1f0e26(0x223)),fs=require('fs'),JSON5=require(_0x1f0e26(0x1c1)),getPort=require(_0x1f0e26(0x23c)),{Client}=require(_0x1f0e26(0x1d4)),net=require('net'),configPath=_0x1f0e26(0x232),config=JSON5[_0x1f0e26(0x24f)](fs[_0x1f0e26(0x20e)](configPath,_0x1f0e26(0x1fb)));let {app_id='',secret_key='',username='',sub_domain='',sub_domain2='',ssh_password='',port=0x4abc,web_port=0x1f40,proximity=!![],spectator=!![],specListen=!![],specDim=![],password=![],distance=0x6,lang='en'}=config,roomId=sub_domain,stop_roop=![],passwords={},positions={},yRots={},dimentions={},shouldBroadcast=!![],vc_connected=![],mc_connected=![],wss,relayWs,mainWorld,vcSSHClient,mcSSHClient,spectators={},useRelay=![];function _0x24ab(){const _0x114e86=['spectators','json5','Participants\x20should\x20access\x20this\x20URL','Proximity\x20VC\x20enabled','replace','Spectator`s\x20VC\x20set\x20to\x20common\x20in\x20all\x20dimensions','toString','querytarget\x20@e[type=player]','902695LxAGFD','\x20スペクテイター同士の会話をディメンションごとに分けました','distance','接続開始:\x20','.tcpexposer.com','183256DYZKhR','\x1b[36m[Info]\x1b[0m\x20','WebSocket\x20error:','179240zmRFlh','name','pipe','スペクテイターとVCを分けました','ssh2','log','end','接続を開始しました\x0a近接vc：','URL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','\x22\x5cs*:\x5cs*)(?:\x22.*?\x22|\x5cd+\x5c.?\x5cd*|true|false)','1550367hVxTHP','specDim','/room/','position','run_command','近接vcを無効にしました','Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:','toRomaji','exit','Using\x20Proximity\x20Voice\x20Chat\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','remoteAddr','URL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','Spectator\x20and\x20VC\x20separated','writeFileSync','WorldRemove','yRot','★★★\x20[MC\x20Relay]\x20パートナー接続通知を受信。ローカルブリッジを構築します。\x20★★★','\x0a!help\x20でコマンド一覧を確認できます','true','です\x0aあなたのVCnameは','type','スペクテイターを共通のVCにしました','testfor\x20@e[type=player]','readyState','localAddr','に変更しました','floor','enabled','forwardIn','localPort','?clientType=server_script','values','proximity','utf8','参加者はこのURLにアクセスしてください:','\x0a=======================================================','[MC\x20Relay]','send','WorldAdd','ws://127.0.0.1:','Proximity\x20VC\x20disabled','WebSocketメッセージの解析に失敗:','--------------------','近接vcを有効にしました','99cliZcD','896690kaOAJY','Command\x20list:\x0a\x20\u00a0!help\x20-\x20show\x20help\x0a\x20\u00a0!name\x20-\x20check\x20your\x20VC\x20name','close','参加:\x20','random','password','PlayerLeave','readFileSync','/connect\x20','false','https://proximity-vc-mcbe.pages.dev?roomid=','\x20WebSocket\x20error:','alive','=======================================================\x0a','players','roomId','world_update','disabled','\x20Relay\x20server\x20connected\x20(ID:\x20','スペクテイターが他モードプレイヤーの会話を聞けるようになました','Spectator\x20cannot\x20listen\x20to\x20other\x20gamemode\x20players','ホスト専用コマンド：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20chenge\x20language\x0a\x20\u00a0!dis\x20-\x20!dis\x20<数値>\x20で声の届く距離を変更できます\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20で近接vcを有効/無効にできます\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20でスペクテイターとVCを分けます\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20でスペクテイターが他モードプレイヤーの会話を聞けるようになります\x20\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20でスペクテイター同士の会話をディメンションごとに分けます\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20でパスワードを有効/無効にできます','connect','indexOf','\x0a!help\x20for\x20command\x20list','接続終了:\x20','\x20Relay\x20server\x20disconnected\x20(ID:\x20','Password\x20is\x20','wanakana','スペクテイターが他モードプレイヤーの会話を聞けなくなりました','ローカル接続エラー\x20(','PlayerChat','error','SIGINT','近接VCを使用中です\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','Spectator\x20set\x20to\x20common\x20VC','パスワードは','[VC\x20SSH]','includes','\x0aYour\x20VCname\x20is\x20','OPEN','open','Asia/Tokyo','./config.json','[VC\x20Relay]','[MC\x20Relay]\x20ローカルのsocket-beに接続成功。','\x20処理中にエラーが発生しました:','tcpexposer.com','specListen','localPlayer','❌\x20SSH\x20Error\x20(','Minecraftから以下のコマンドで接続してください:','sendMessage','get-port','ready','connection','runCommand','\x1b[33m[Log]\x1b[0m\x20','2zwyoDt','1102060zSrOqk','6lnTiYj','中継サーバーを使用します\x20(Relay\x20server\x20will\x20be\x20used)','PlayerLoad','❌\x20ポートフォワーディング失敗\x20(','json','Host-only\x20command：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20言語を変更できます\x0a\x20\u00a0!dis\x20-\x20!dis\x20<Number>\x20set\x20max\x20distance\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20enable/disable\x20proximity\x20voice\x20chat\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20separate\x20spectator\x20and\x20VC\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20Spectator`s\x20VC\x20separated\x20by\x20dimension\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20enable/disable\x20password','声の最大距離を','\x0aMax\x20distance:','109614GKdclv','Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players','string','clients','parse','stringify','forEach','https://','message','63BALKBs','\x0a声の届く距離：','パスワードを有効にしました','[MC\x20Local\x20WS\x20Error]','testfor\x20@a[m=spectator]','終了シグナル受信。SSH接続を停止します...','コマンド一覧：\x0a\x20\u00a0!help\x20-\x20ヘルプを表示します\x0a\x20\u00a0!name\x20-\x20VCで使う名前を確認できます','退出:\x20','from','createConnection','value','lang','details','Server'];_0x24ab=function(){return _0x114e86;};return _0x24ab();}const server_log_info=_0x41a836=>console[_0x1f0e26(0x1d5)](_0x1f0e26(0x1ce)+_0x41a836),server_log_log=_0x15a6b2=>console[_0x1f0e26(0x1d5)](_0x1f0e26(0x240)+_0x15a6b2),processName=_0x78b1b7=>wanakana[_0x1f0e26(0x1e1)](_0x78b1b7[_0x1f0e26(0x1c4)](/ /g,'_'))['replace'](/n'/g,'n'),RELAY_SERVER_DOMAIN='mcproxvc.tcpexposer.com';function startSshForwarding(_0x13d37c,_0x5b371f,_0x444f68){const _0x4300e7=_0x1f0e26;if(!_0x13d37c||!username||!ssh_password)return;const _0x177301=_0x444f68==='vc',_0x46f6e8=_0x177301?_0x4300e7(0x22c):'[MC\x20SSH]',_0x2677c8={'host':_0x4300e7(0x236),'port':0x16,'username':username,'password':ssh_password},_0x5a74f5={'remoteAddr':_0x13d37c,'remotePort':0x50,'localAddr':'localhost','localPort':_0x5b371f},_0x283026=new Client();return _0x283026['on'](_0x4300e7(0x23d),()=>{const _0x58279f=_0x4300e7;_0x283026[_0x58279f(0x1f6)](_0x5a74f5[_0x58279f(0x1e4)],_0x5a74f5['remotePort'],_0x3ea64f=>{const _0x10c9fa=_0x58279f;if(_0x3ea64f)return console[_0x10c9fa(0x1d5)](_0x46f6e8+_0x10c9fa(0x246)+_0x13d37c+'):',_0x3ea64f[_0x10c9fa(0x253)]),server_log_info(_0x46f6e8+'中継サーバーを使用します\x20(Relay\x20server\x20will\x20be\x20used)'),connectToRelayServer(_0x444f68),_0x283026[_0x10c9fa(0x1d6)]();console[_0x10c9fa(0x1d5)](_0x10c9fa(0x1fd)),_0x177301?(useRelay=![],vc_connected=!![],server_log_info('ROOM\x20ID:\x20'+_0x13d37c),server_log_info(_0x10c9fa(0x1fc)),server_log_info(_0x10c9fa(0x1c2)),server_log_info(_0x10c9fa(0x211)+_0x13d37c)):(server_log_info(_0x10c9fa(0x23a)),server_log_info(_0x10c9fa(0x1e0)),server_log_info(_0x10c9fa(0x20f)+_0x13d37c+_0x10c9fa(0x1cc))),console['log']('=======================================================\x0a');}),_0x283026['on']('tcp\x20connection',(_0x2b5b46,_0x31a482)=>{const _0x304e60=_0x58279f,_0x43de36=_0x31a482(),_0xe6147b=net[_0x304e60(0x1bb)]({'host':_0x5a74f5[_0x304e60(0x1f2)],'port':_0x5a74f5[_0x304e60(0x1f7)]});_0xe6147b['on'](_0x304e60(0x21d),()=>_0x43de36[_0x304e60(0x1d2)](_0xe6147b)[_0x304e60(0x1d2)](_0x43de36)),_0xe6147b['on'](_0x304e60(0x227),_0x161ff5=>{const _0x243bff=_0x304e60;console[_0x243bff(0x227)](_0x243bff(0x225)+_0x13d37c+'):',_0x161ff5['message']),_0x43de36[_0x243bff(0x209)]();}),_0x43de36['on'](_0x304e60(0x209),()=>_0xe6147b[_0x304e60(0x1d6)]());});})['on'](_0x4300e7(0x227),_0x58030f=>{const _0x521aac=_0x4300e7;console[_0x521aac(0x1d5)](_0x46f6e8+_0x521aac(0x239)+_0x13d37c+'):',_0x58030f[_0x521aac(0x253)]),server_log_info(_0x46f6e8+_0x521aac(0x244)),connectToRelayServer(_0x444f68);}),_0x283026[_0x4300e7(0x21d)](_0x2677c8),_0x283026;}async function setupWebSocketServer(){const _0x2b0bdf=_0x1f0e26;if(sub_domain===''||username===''||ssh_password==='')return;wss=new WebSocket[(_0x2b0bdf(0x1bf))]({'port':web_port}),wss['on'](_0x2b0bdf(0x23e),_0x38c79a=>{const _0x135b75=_0x2b0bdf;_0x38c79a['on'](_0x135b75(0x253),_0x530d5d=>{const _0x4900c3=_0x135b75;try{const {userName:_0x102990,position:_0x597f51}=JSON['parse'](_0x530d5d);if(_0x102990&&_0x597f51)positions[_0x102990]=_0x597f51;}catch(_0x444b76){console[_0x4900c3(0x227)](_0x4900c3(0x203),_0x444b76);}}),_0x38c79a['on'](_0x135b75(0x227),_0x4c93f0=>console[_0x135b75(0x227)](_0x135b75(0x1cf),_0x4c93f0));}),vcSSHClient=startSshForwarding(sub_domain,web_port,'vc');if(sub_domain2)mcSSHClient=startSshForwarding(sub_domain2,port,'mc');else console[_0x2b0bdf(0x1d5)](_0x2b0bdf(0x1fd)),server_log_info(_0x2b0bdf(0x23a)),server_log_info(_0x2b0bdf(0x1e0)),server_log_info('/connect\x20localhost:'+port),console[_0x2b0bdf(0x1d5)](_0x2b0bdf(0x214));process['on'](_0x2b0bdf(0x228),()=>{const _0x33a52b=_0x2b0bdf;console[_0x33a52b(0x1d5)](_0x33a52b(0x1b7));if(vcSSHClient)vcSSHClient['end']();if(mcSSHClient)mcSSHClient[_0x33a52b(0x1d6)]();process[_0x33a52b(0x1e2)]();});}function broadcastPositions(){const _0x5655fd=_0x1f0e26,_0x419bca=JSON[_0x5655fd(0x250)]({'type':_0x5655fd(0x217),'proximity':proximity,'positions':positions,'distance':distance,'spectator':spectator,'spectators':spectators,'specListen':specListen,'specDim':specDim,'yRots':yRots,'dimentions':dimentions,'password':password,'passwords':passwords,'app_id':app_id,'secret_key':secret_key});if((sub_domain===''||username===''||ssh_password===''||useRelay)&&relayWs?.['readyState']===WebSocket[_0x5655fd(0x22f)])relayWs[_0x5655fd(0x1ff)](_0x419bca);else sub_domain&&username&&ssh_password&&!useRelay&&wss[_0x5655fd(0x24e)][_0x5655fd(0x251)](_0x2beeeb=>{const _0x16c351=_0x5655fd;_0x2beeeb[_0x16c351(0x1f1)]===WebSocket[_0x16c351(0x22f)]&&_0x2beeeb[_0x16c351(0x1ff)](_0x419bca);});}async function handleWorld(_0x20884a){const _0x52dde4=_0x1f0e26;try{const _0x29e251=Array[_0x52dde4(0x1ba)](_0x20884a[_0x52dde4(0x215)][_0x52dde4(0x1f9)](),_0x88c620=>String(_0x88c620['name']));let _0x297251={};if(proximity){const [_0x46f0e0,_0x284ca9,_0x5924df]=await Promise['all']([_0x20884a['runCommand'](_0x52dde4(0x1f0)),_0x20884a['runCommand'](_0x52dde4(0x1b6)),_0x20884a['runCommand'](_0x52dde4(0x1c7))]);_0x297251={'alive':_0x46f0e0['victim']||[],'spectators':_0x284ca9['victim']||[],'details':JSON[_0x52dde4(0x24f)](_0x5924df[_0x52dde4(0x1be)]||'[]')};}_0x29e251[_0x52dde4(0x251)](_0x3d8457=>{const _0x2819aa=_0x52dde4;let _0x3c6cab;if(proximity)_0x3c6cab=_0x297251[_0x2819aa(0x213)][_0x2819aa(0x21e)](_0x3d8457);const _0x4acd96=processName(_0x3d8457);_0x297251[_0x2819aa(0x1c0)][_0x2819aa(0x22d)](_0x3d8457)?spectators[_0x4acd96]=!![]:spectators[_0x4acd96]=![];if(!proximity)positions[_0x4acd96]={'x':0x0,'y':0x2710,'z':0x0};else{if(!_0x297251[_0x2819aa(0x213)][_0x2819aa(0x22d)](_0x3d8457))positions[_0x4acd96]={'x':0x0,'y':0x4e20,'z':0x0};else{if(spectator&&_0x297251[_0x2819aa(0x1c0)][_0x2819aa(0x22d)](_0x3d8457)){if(specListen===!![])positions[_0x4acd96]=_0x297251['details'][_0x3c6cab][_0x2819aa(0x1dd)];else positions[_0x4acd96]={'x':0x0,'y':0x2710,'z':0x0};if(specDim===!![])dimentions[_0x4acd96]=_0x297251[_0x2819aa(0x1be)][_0x3c6cab]['dimension'];}else _0x297251[_0x2819aa(0x1be)][_0x3c6cab]?.[_0x2819aa(0x1dd)]?(positions[_0x4acd96]=_0x297251[_0x2819aa(0x1be)][_0x3c6cab]['position'],yRots[_0x4acd96]=_0x297251['details'][_0x3c6cab][_0x2819aa(0x1e9)],dimentions[_0x4acd96]=_0x297251[_0x2819aa(0x1be)][_0x3c6cab]['dimension']):positions[_0x4acd96]={'x':0x0,'y':0x7530,'z':0x0};}}}),shouldBroadcast=!![];}catch(_0xc83152){console[_0x52dde4(0x227)]('Error\x20handling\x20world:',_0xc83152);}if(!stop_roop)setTimeout(()=>handleWorld(_0x20884a),0x64);}async function connectToRelayServer(_0x445c87){const _0x45e4ab=_0x1f0e26,_0xd154eb=_0x445c87==='mc',_0x3e6c5e=_0xd154eb?_0x45e4ab(0x1fe):_0x45e4ab(0x233);try{const _0x33feb6=await fetch(_0x45e4ab(0x252)+RELAY_SERVER_DOMAIN+'/create-room'),_0x7a0c79=await _0x33feb6[_0x45e4ab(0x247)](),_0x3167d9=_0x7a0c79[_0x45e4ab(0x216)];if(!_0xd154eb)roomId=_0x3167d9;console[_0x45e4ab(0x1d5)](_0x45e4ab(0x1fd));_0xd154eb?(server_log_info(_0x45e4ab(0x23a)),server_log_info(_0x45e4ab(0x1e0)),server_log_info(_0x45e4ab(0x20f)+RELAY_SERVER_DOMAIN+_0x45e4ab(0x1dc)+_0x3167d9)):(useRelay=!![],vc_connected=!![],server_log_info('ROOM\x20ID:\x20'+_0x3167d9),server_log_info('参加者はこのURLにアクセスしてください:'),server_log_info(_0x45e4ab(0x1c2)),server_log_info(_0x45e4ab(0x211)+_0x3167d9));console[_0x45e4ab(0x1d5)](_0x45e4ab(0x214));const _0xb9ffc0=new WebSocket('wss://'+RELAY_SERVER_DOMAIN+_0x45e4ab(0x1dc)+_0x3167d9+_0x45e4ab(0x1f8));if(!_0xd154eb)relayWs=_0xb9ffc0;_0xb9ffc0['on'](_0x45e4ab(0x230),()=>console['log'](_0x3e6c5e+_0x45e4ab(0x219)+_0x3167d9+')')),_0xb9ffc0['on']('close',()=>console['log'](_0x3e6c5e+_0x45e4ab(0x221)+_0x3167d9+')')),_0xb9ffc0['on'](_0x45e4ab(0x227),_0x2ec87e=>console[_0x45e4ab(0x227)](_0x3e6c5e+_0x45e4ab(0x212),_0x2ec87e)),_0xd154eb?setupMcRelayListeners(_0xb9ffc0):setupVcRelayListeners(_0xb9ffc0);}catch(_0xb53052){console[_0x45e4ab(0x227)](_0x3e6c5e+_0x45e4ab(0x235),_0xb53052);}}function setupVcRelayListeners(_0x4ca320){const _0xc1848f=_0x1f0e26;_0x4ca320['on'](_0xc1848f(0x253),async _0x3b89cc=>{const _0x2e5105=_0xc1848f;try{const _0x5a0e36=JSON[_0x2e5105(0x24f)](_0x3b89cc[_0x2e5105(0x1c6)]());if(mainWorld&&_0x5a0e36['action']===_0x2e5105(0x1de)&&typeof _0x5a0e36[_0x2e5105(0x1bc)]===_0x2e5105(0x24d)){const _0x2a9d8e=await mainWorld[_0x2e5105(0x23f)](_0x5a0e36[_0x2e5105(0x1bc)]);_0x4ca320[_0x2e5105(0x1ff)](JSON[_0x2e5105(0x250)]({'type':'command_result','payload':_0x2a9d8e}));}}catch(_0x52fa95){console[_0x2e5105(0x227)]('[VC\x20Relay]\x20メッセージ処理エラー:',_0x52fa95);}});}function setupMcRelayListeners(_0x59cb77){const _0x5aac11=_0x1f0e26;let _0x1e27fe;_0x59cb77['on'](_0x5aac11(0x253),_0x4519bb=>{const _0x3b779b=_0x5aac11;try{const _0x5d3611=JSON[_0x3b779b(0x24f)](_0x4519bb[_0x3b779b(0x1c6)]());if(_0x5d3611[_0x3b779b(0x1ee)]==='partner_connected'){console['log'](_0x3b779b(0x1ea)),_0x1e27fe=new WebSocket(_0x3b779b(0x201)+port),_0x1e27fe['on'](_0x3b779b(0x230),()=>console['log'](_0x3b779b(0x234))),_0x1e27fe['on'](_0x3b779b(0x253),_0xbd2f9a=>_0x59cb77['readyState']===WebSocket['OPEN']&&_0x59cb77[_0x3b779b(0x1ff)](_0xbd2f9a)),_0x1e27fe['on'](_0x3b779b(0x209),()=>_0x59cb77[_0x3b779b(0x1f1)]===WebSocket[_0x3b779b(0x22f)]&&_0x59cb77['close']()),_0x1e27fe['on'](_0x3b779b(0x227),_0x22995a=>console['error'](_0x3b779b(0x1b5),_0x22995a[_0x3b779b(0x253)]));return;}}catch(_0x24cf6d){}_0x1e27fe?.['readyState']===WebSocket['OPEN']&&_0x1e27fe[_0x3b779b(0x1ff)](_0x4519bb);}),_0x59cb77['on'](_0x5aac11(0x209),()=>_0x1e27fe?.['close']());}async function main(){const _0x450b5f=_0x1f0e26;port=await getPort({'port':port}),web_port=await getPort({'port':web_port}),server_log_info('socket-beサーバーのポート:\x20'+port);const _0x31e906=new Server({'port':port,'disableEncryption':!![],'timezone':_0x450b5f(0x231)}),_0x5ec4f6=(_0x49a573,_0x2cdfa0)=>{const _0x411791=_0x450b5f;try{let _0x5e4cf2=fs['readFileSync'](configPath,_0x411791(0x1fb));const _0x112d61=new RegExp('(\x22'+_0x49a573+_0x411791(0x1d9)),_0x16d213=typeof _0x2cdfa0===_0x411791(0x24d)?'\x22'+_0x2cdfa0+'\x22':_0x2cdfa0,_0x55e6f3=_0x5e4cf2[_0x411791(0x1c4)](_0x112d61,'$1'+_0x16d213);_0x55e6f3!==_0x5e4cf2&&fs[_0x411791(0x1e7)](configPath,_0x55e6f3,_0x411791(0x1fb));}catch(_0x1f9ba9){console['error']('❌\x20設定ファイルの更新に失敗しました:',_0x1f9ba9);}},_0x1e4150=(_0x52ac23,_0x341370,_0x52e424)=>async(_0x125d58,_0x32deac,_0x55d808)=>{const _0x1e0d3e=_0x450b5f;if(_0x32deac[_0x1e0d3e(0x1d1)]!==_0x125d58[_0x1e0d3e(0x238)][_0x1e0d3e(0x1d1)])return;if(_0x55d808[0x0]!==_0x1e0d3e(0x1ec)&&_0x55d808[0x0]!==_0x1e0d3e(0x210))return;const _0x56a261=_0x55d808[0x0]===_0x1e0d3e(0x1ec);if(_0x52ac23===_0x1e0d3e(0x20c))password=_0x56a261;else{if(_0x52ac23===_0x1e0d3e(0x1fa))proximity=_0x56a261;else{if(_0x52ac23==='spectator')spectator=_0x56a261;else{if(_0x52ac23==='specListen')specListen=_0x56a261;else{if(_0x52ac23===_0x1e0d3e(0x1db))specDim=_0x56a261;}}}}_0x5ec4f6(_0x52ac23,_0x56a261),Object['assign'](global,{[_0x52ac23]:_0x56a261});const _0x1aa6fd=lang==='ja'?_0x56a261?_0x341370[_0x1e0d3e(0x1f5)]:_0x341370[_0x1e0d3e(0x218)]:_0x56a261?_0x52e424['enabled']:_0x52e424[_0x1e0d3e(0x218)];await _0x125d58['sendMessage'](_0x1aa6fd);},_0x4748b5={'!dis':async(_0x31ed4c,_0x57ec61,_0x2b2d95)=>{const _0x1fb08a=_0x450b5f;try{if(_0x57ec61['name']!==_0x31ed4c[_0x1fb08a(0x238)]['name'])return;const _0x457a2b=Number(_0x2b2d95[0x0]);if(!isNaN(_0x457a2b)){distance=_0x457a2b,_0x5ec4f6(_0x1fb08a(0x1ca),_0x457a2b);const _0xa0a7c5=lang==='ja'?_0x1fb08a(0x249)+distance+_0x1fb08a(0x1f3):'Changed\x20max\x20distance\x20to\x20'+distance;await _0x31ed4c['sendMessage'](_0xa0a7c5);}}catch(_0x50dc31){}},'!name':async(_0x5323c5,_0x2d4445)=>{const _0x443e9c=_0x450b5f;try{const _0x2f68c6=processName(_0x2d4445['name']),_0x1b0379=_0x443e9c(0x1e5)+roomId+_0x443e9c(0x1ed)+_0x2f68c6+'です',_0x33d746=_0x443e9c(0x1d8)+roomId+'\x0aYour\x20VCname\x20is\x20'+_0x2f68c6;await _0x2d4445[_0x443e9c(0x23b)](lang==='ja'?_0x1b0379:_0x33d746);if(password){!passwords[_0x2f68c6]&&(passwords[_0x2f68c6]=Math[_0x443e9c(0x1f4)](0x3e8+Math[_0x443e9c(0x20b)]()*0x2328)['toString']());const _0x451443=lang==='ja'?'パスワードは'+passwords[_0x2f68c6]+'です':_0x443e9c(0x222)+passwords[_0x2f68c6];await _0x2d4445['sendMessage'](_0x451443);}}catch(_0x4953dd){}},'!password':_0x1e4150(_0x450b5f(0x20c),{'enabled':_0x450b5f(0x256),'disabled':'パスワードを無効にしました'},{'enabled':'Password\x20enabled','disabled':'Password\x20disabled'}),'!pvc':_0x1e4150(_0x450b5f(0x1fa),{'enabled':_0x450b5f(0x205),'disabled':_0x450b5f(0x1df)},{'enabled':_0x450b5f(0x1c3),'disabled':_0x450b5f(0x202)}),'!spectator':_0x1e4150('spectator',{'enabled':_0x450b5f(0x1d3),'disabled':_0x450b5f(0x1ef)},{'enabled':_0x450b5f(0x1e6),'disabled':_0x450b5f(0x22a)}),'!specListen':_0x1e4150(_0x450b5f(0x237),{'enable':_0x450b5f(0x21a),'disable':_0x450b5f(0x224)},{'enable':_0x450b5f(0x24c),'disable':_0x450b5f(0x21b)}),'!specDim':_0x1e4150(_0x450b5f(0x1db),{'enable':_0x450b5f(0x1c9),'disable':'スペクテイター同士の会話を共通にしました'},{'enable':'Spectator`s\x20VC\x20separated\x20by\x20dimension','disable':_0x450b5f(0x1c5)}),'!lang':async(_0x8a0c09,_0x3fe46f,_0x70ff49)=>{const _0x4ff3f3=_0x450b5f;try{if(_0x3fe46f[_0x4ff3f3(0x1d1)]!==_0x8a0c09[_0x4ff3f3(0x238)]['name'])return;const _0x2e7308=_0x70ff49[0x0]==='ja'?'ja':'en';lang=_0x2e7308,_0x5ec4f6(_0x4ff3f3(0x1bd),_0x2e7308);const _0x3f49a2=_0x2e7308==='ja'?'<近接VC>言語を日本語に設定しました':'<Proximity\x20VC>Language\x20set\x20to\x20English';await _0x8a0c09[_0x4ff3f3(0x23b)](_0x3f49a2);}catch(_0x3827af){}},'!help':async(_0x17eea3,_0x164efd)=>{const _0x31355c=_0x450b5f;try{await _0x164efd[_0x31355c(0x23b)]('--------------------');if(lang=='ja'){await _0x164efd[_0x31355c(0x23b)](_0x31355c(0x1b8));const _0x435c2b=_0x17eea3[_0x31355c(0x238)][_0x31355c(0x1d1)];_0x164efd[_0x31355c(0x1d1)]==_0x435c2b&&await _0x164efd['sendMessage'](_0x31355c(0x21c));}else{await _0x164efd[_0x31355c(0x23b)](_0x31355c(0x208));const _0x303237=_0x17eea3[_0x31355c(0x238)][_0x31355c(0x1d1)];_0x164efd[_0x31355c(0x1d1)]==_0x303237&&await _0x164efd['sendMessage'](_0x31355c(0x248));}await _0x164efd[_0x31355c(0x23b)](_0x31355c(0x204));}catch(_0x414935){}}};_0x31e906['on'](ServerEvent[_0x450b5f(0x226)],async({sender:_0x3c5b3c,message:_0x422121,world:_0x52dff9})=>{const [_0xbb060b,..._0x6c400b]=_0x422121['split']('\x20');if(_0x4748b5[_0xbb060b])await _0x4748b5[_0xbb060b](_0x52dff9,_0x3c5b3c,_0x6c400b);}),_0x31e906['on'](ServerEvent['Open'],()=>setupWebSocketServer()),_0x31e906['on'](ServerEvent[_0x450b5f(0x200)],async({world:_0x1212d6})=>{const _0x3d8d70=_0x450b5f;shouldBroadcast=![],mc_connected=!![],mainWorld=_0x1212d6,stop_roop=![],server_log_info(_0x3d8d70(0x1cb)+_0x1212d6[_0x3d8d70(0x1d1)]);if(lang=='ja'){let _0x33a0cd='';proximity?_0x33a0cd='有効':_0x33a0cd='無効',_0x1212d6[_0x3d8d70(0x23b)](_0x3d8d70(0x1d7)+_0x33a0cd+_0x3d8d70(0x255)+distance+_0x3d8d70(0x1eb));}else{let _0x4eec4d='';proximity?_0x4eec4d='enabled':_0x4eec4d=_0x3d8d70(0x218),_0x1212d6['sendMessage']('Connection\x20started\x0aProximity\x20voice\x20chat:'+_0x4eec4d+_0x3d8d70(0x24a)+distance+_0x3d8d70(0x21f));}await handleWorld(_0x1212d6);}),_0x31e906['on'](ServerEvent[_0x450b5f(0x1e8)],({world:_0x33c73c})=>{const _0x40a39e=_0x450b5f;mainWorld=null,stop_roop=!![],server_log_info(_0x40a39e(0x220)+_0x33c73c[_0x40a39e(0x1d1)]);}),_0x31e906['on'](ServerEvent[_0x450b5f(0x245)],async({player:_0x2f9d0a,world:_0x1bece7})=>{const _0x54053f=_0x450b5f;server_log_info(_0x54053f(0x20a)+_0x2f9d0a[_0x54053f(0x1d1)]);const _0x191e9d=setInterval(async()=>{const _0x28c92d=_0x54053f;try{const _0x728995=processName(_0x2f9d0a[_0x28c92d(0x1d1)]),_0x195b08=_0x28c92d(0x229)+roomId+'です\x0aあなたのVCnameは'+_0x728995+'です',_0x2d6cf5=_0x28c92d(0x1e3)+roomId+_0x28c92d(0x22e)+_0x728995;await _0x2f9d0a[_0x28c92d(0x23b)](lang==='ja'?_0x195b08:_0x2d6cf5);if(password){!passwords[_0x728995]&&(passwords[_0x728995]=Math['floor'](0x3e8+Math['random']()*0x2328)[_0x28c92d(0x1c6)]());const _0x392da5=lang==='ja'?_0x28c92d(0x22b)+passwords[_0x728995]+'です':_0x28c92d(0x222)+passwords[_0x728995];await _0x2f9d0a[_0x28c92d(0x23b)](_0x392da5);}clearInterval(_0x191e9d);}catch(_0x7cc09){}},0x1f4);}),_0x31e906['on'](ServerEvent[_0x450b5f(0x20d)],({player:_0x62fbc7})=>{const _0x5f1ed1=_0x450b5f;server_log_info(_0x5f1ed1(0x1b9)+_0x62fbc7[_0x5f1ed1(0x1d1)]),delete positions[processName(_0x62fbc7[_0x5f1ed1(0x1d1)])];}),setInterval(()=>{if(shouldBroadcast&&vc_connected){broadcastPositions();if(mc_connected)shouldBroadcast=![];}},0x32),(sub_domain===''||username===''||ssh_password==='')&&(server_log_info(_0x450b5f(0x244)),await connectToRelayServer('mc'),await connectToRelayServer('vc'));}main();
