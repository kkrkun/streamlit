const _0x3d20aa=_0x2d07;(function(_0x5dbf90,_0x48c8b0){const _0x23e4b7=_0x2d07,_0x23e490=_0x5dbf90();while(!![]){try{const _0x34eb31=parseInt(_0x23e4b7(0x12c))/0x1+-parseInt(_0x23e4b7(0xf4))/0x2*(parseInt(_0x23e4b7(0xd2))/0x3)+-parseInt(_0x23e4b7(0xac))/0x4*(parseInt(_0x23e4b7(0xd5))/0x5)+parseInt(_0x23e4b7(0xb4))/0x6*(-parseInt(_0x23e4b7(0xae))/0x7)+-parseInt(_0x23e4b7(0xc2))/0x8*(-parseInt(_0x23e4b7(0xcb))/0x9)+-parseInt(_0x23e4b7(0x103))/0xa+parseInt(_0x23e4b7(0x11d))/0xb;if(_0x34eb31===_0x48c8b0)break;else _0x23e490['push'](_0x23e490['shift']());}catch(_0x4e728c){_0x23e490['push'](_0x23e490['shift']());}}}(_0x2606,0x9c6e3));const {Server,ServerEvent}=require(_0x3d20aa(0x146)),WebSocket=require('ws'),fetch=require(_0x3d20aa(0xea)),wanakana=require(_0x3d20aa(0xeb)),fs=require('fs'),JSON5=require('json5'),getPort=require('get-port'),{Client}=require('ssh2'),net=require(_0x3d20aa(0xe8)),configPath=_0x3d20aa(0xa8),config=JSON5[_0x3d20aa(0xf0)](fs['readFileSync'](configPath,'utf8'));let {app_id='',secret_key='',username='',sub_domain='',sub_domain2='',ssh_password='',port=0x4abc,web_port=0x1f40,proximity=!![],spectator=!![],specListen=!![],specDim=![],password=![],distance=0x6,lang='en'}=config,roomId=sub_domain,stop_roop=![],passwords={},positions={},yRots={},dimentions={},shouldBroadcast=!![],vc_connected=![],mc_connected=![],wss,relayWs,mainWorld,vcSSHClient,mcSSHClient,spectators={},useRelay=![];const server_log_info=_0x4e3a8f=>console[_0x3d20aa(0xba)](_0x3d20aa(0xf8)+_0x4e3a8f),server_log_log=_0xe1ee5c=>console[_0x3d20aa(0xba)](_0x3d20aa(0xdf)+_0xe1ee5c),processName=_0x4289ba=>wanakana[_0x3d20aa(0x123)](_0x4289ba[_0x3d20aa(0xb8)](/ /g,'_'))['replace'](/n'/g,'n'),RELAY_SERVER_DOMAIN=_0x3d20aa(0x111);function startSshForwarding(_0x3af422,_0x119a42,_0x11a5fe){const _0x3d381b=_0x3d20aa;if(!_0x3af422||!username||!ssh_password)return;const _0x19c0dd=_0x11a5fe==='vc',_0x3a1ce7=_0x19c0dd?_0x3d381b(0xc1):'[MC\x20SSH]',_0x4396f9={'host':_0x3d381b(0x10b),'port':0x16,'username':username,'password':ssh_password},_0x2a41c8={'remoteAddr':_0x3af422,'remotePort':0x50,'localAddr':'localhost','localPort':_0x119a42},_0x132d9c=new Client();return _0x132d9c['on'](_0x3d381b(0xaa),()=>{const _0x252335=_0x3d381b;_0x132d9c[_0x252335(0x12d)](_0x2a41c8[_0x252335(0xa7)],_0x2a41c8[_0x252335(0x10c)],_0x4f46b0=>{const _0x1589e9=_0x252335;if(_0x4f46b0)return console['error'](_0x3a1ce7+_0x1589e9(0xd0)+_0x3af422+'):',_0x4f46b0[_0x1589e9(0xfa)]),server_log_info(_0x3a1ce7+_0x1589e9(0x144)),connectToRelayServer(_0x11a5fe),_0x132d9c[_0x1589e9(0x109)]();console[_0x1589e9(0xba)](_0x1589e9(0xa9)),_0x19c0dd?(useRelay=![],vc_connected=!![],server_log_info(_0x1589e9(0xc6)+_0x3af422),server_log_info('参加者はこのURLにアクセスしてください:'),server_log_info(_0x1589e9(0x12b)),server_log_info(_0x1589e9(0x143)+_0x3af422)):(server_log_info(_0x1589e9(0xec)),server_log_info(_0x1589e9(0x10d)),server_log_info(_0x1589e9(0x10a)+_0x3af422+_0x1589e9(0xca))),console[_0x1589e9(0xba)]('=======================================================\x0a');}),_0x132d9c['on']('tcp\x20connection',(_0x551ee7,_0x2b07aa)=>{const _0x19ea34=_0x252335,_0x3f1c33=_0x2b07aa(),_0x3611d0=net['createConnection']({'host':_0x2a41c8[_0x19ea34(0xab)],'port':_0x2a41c8[_0x19ea34(0xc3)]});_0x3611d0['on'](_0x19ea34(0x118),()=>_0x3f1c33[_0x19ea34(0xc5)](_0x3611d0)['pipe'](_0x3f1c33)),_0x3611d0['on'](_0x19ea34(0xc9),_0x472e11=>{const _0x3f60da=_0x19ea34;console[_0x3f60da(0xc9)](_0x3f60da(0xd9)+_0x3af422+'):',_0x472e11[_0x3f60da(0xfa)]),_0x3f1c33[_0x3f60da(0x12e)]();}),_0x3f1c33['on']('close',()=>_0x3611d0[_0x19ea34(0x109)]());});})['on']('error',_0x6b7200=>{const _0xac500d=_0x3d381b;console[_0xac500d(0xc9)]('❌\x20SSH\x20Error\x20('+_0x3af422+'):',_0x6b7200[_0xac500d(0xfa)]),server_log_info(_0x3a1ce7+_0xac500d(0x144)),connectToRelayServer(_0x11a5fe);}),_0x132d9c['connect'](_0x4396f9),_0x132d9c;}async function setupWebSocketServer(){const _0x4f72e8=_0x3d20aa;if(sub_domain===''||username===''||ssh_password==='')return;wss=new WebSocket[(_0x4f72e8(0xb1))]({'port':web_port}),wss['on'](_0x4f72e8(0x12f),_0x561369=>{const _0xf72b39=_0x4f72e8;_0x561369['on'](_0xf72b39(0xfa),_0x466058=>{const _0xfb0da2=_0xf72b39;try{const {userName:_0x3630e2,position:_0xd2cbc4}=JSON[_0xfb0da2(0xf0)](_0x466058);if(_0x3630e2&&_0xd2cbc4)positions[_0x3630e2]=_0xd2cbc4;}catch(_0x2e0b1a){console[_0xfb0da2(0xc9)](_0xfb0da2(0x114),_0x2e0b1a);}}),_0x561369['on'](_0xf72b39(0xc9),_0x3c7622=>console[_0xf72b39(0xc9)](_0xf72b39(0xa6),_0x3c7622));}),vcSSHClient=startSshForwarding(sub_domain,web_port,'vc');if(sub_domain2)mcSSHClient=startSshForwarding(sub_domain2,port,'mc');else console['log']('\x0a======================================================='),server_log_info(_0x4f72e8(0xec)),server_log_info('Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:'),server_log_info('/connect\x20localhost:'+port),console[_0x4f72e8(0xba)](_0x4f72e8(0xc7));process['on']('SIGINT',()=>{const _0xc5a409=_0x4f72e8;console['log']('終了シグナル受信。SSH接続を停止します...');if(vcSSHClient)vcSSHClient['end']();if(mcSSHClient)mcSSHClient[_0xc5a409(0x109)]();process[_0xc5a409(0x105)]();});}function broadcastPositions(){const _0x1447e0=_0x3d20aa,_0x7e1b7f=JSON[_0x1447e0(0x13c)]({'type':_0x1447e0(0xbd),'proximity':proximity,'positions':positions,'distance':distance,'spectator':spectator,'spectators':spectators,'specListen':specListen,'specDim':specDim,'yRots':yRots,'dimentions':dimentions,'password':password,'passwords':passwords,'app_id':app_id,'secret_key':secret_key});if((sub_domain===''||username===''||ssh_password===''||useRelay)&&relayWs?.[_0x1447e0(0xcd)]===WebSocket[_0x1447e0(0xe7)])relayWs['send'](_0x7e1b7f);else sub_domain&&username&&ssh_password&&!useRelay&&wss['clients']['forEach'](_0x5c0b00=>{const _0x540789=_0x1447e0;_0x5c0b00[_0x540789(0xcd)]===WebSocket[_0x540789(0xe7)]&&_0x5c0b00[_0x540789(0x140)](_0x7e1b7f);});}async function handleWorld(_0x1f5635){const _0x429aa8=_0x3d20aa;try{const _0x18b352=Array[_0x429aa8(0xf1)](_0x1f5635[_0x429aa8(0x119)]['values'](),_0x1da074=>String(_0x1da074['name']));let _0x33eff6={};if(proximity){const [_0x1d8439,_0x2636e2,_0x20d553]=await Promise[_0x429aa8(0xd6)]([_0x1f5635[_0x429aa8(0x130)](_0x429aa8(0xb9)),_0x1f5635[_0x429aa8(0x130)](_0x429aa8(0xdc)),_0x1f5635[_0x429aa8(0x130)](_0x429aa8(0x13e))]);_0x33eff6={'alive':_0x1d8439[_0x429aa8(0x13a)]||[],'spectators':_0x2636e2[_0x429aa8(0x13a)]||[],'details':JSON['parse'](_0x20d553[_0x429aa8(0xe3)]||'[]')};}_0x18b352[_0x429aa8(0x128)](_0x1d446a=>{const _0x1debaa=_0x429aa8;let _0xe4d6c2;if(proximity)_0xe4d6c2=_0x33eff6[_0x1debaa(0x102)][_0x1debaa(0xe5)](_0x1d446a);const _0x33b591=processName(_0x1d446a);_0x33eff6[_0x1debaa(0xd4)][_0x1debaa(0xff)](_0x1d446a)?spectators[_0x33b591]=!![]:spectators[_0x33b591]=![];if(!proximity)positions[_0x33b591]={'x':0x0,'y':0x2710,'z':0x0};else{if(!_0x33eff6[_0x1debaa(0x102)][_0x1debaa(0xff)](_0x1d446a))positions[_0x33b591]={'x':0x0,'y':0x4e20,'z':0x0};else{if(spectator&&_0x33eff6[_0x1debaa(0xd4)][_0x1debaa(0xff)](_0x1d446a)){if(specListen===!![])positions[_0x33b591]=_0x33eff6['details'][_0xe4d6c2]['position'];else positions[_0x33b591]={'x':0x0,'y':0x2710,'z':0x0};if(specDim===!![])dimentions[_0x33b591]=_0x33eff6[_0x1debaa(0xe3)][_0xe4d6c2][_0x1debaa(0x10f)];}else _0x33eff6[_0x1debaa(0xe3)][_0xe4d6c2]?.[_0x1debaa(0xfe)]?(positions[_0x33b591]=_0x33eff6[_0x1debaa(0xe3)][_0xe4d6c2][_0x1debaa(0xfe)],yRots[_0x33b591]=_0x33eff6['details'][_0xe4d6c2][_0x1debaa(0x110)],dimentions[_0x33b591]=_0x33eff6[_0x1debaa(0xe3)][_0xe4d6c2]['dimension']):positions[_0x33b591]={'x':0x0,'y':0x7530,'z':0x0};}}}),shouldBroadcast=!![];}catch(_0x5bfcad){console['error'](_0x429aa8(0x11e),_0x5bfcad);}if(!stop_roop)setTimeout(()=>handleWorld(_0x1f5635),0x64);}async function connectToRelayServer(_0x2997d8){const _0xae1a42=_0x3d20aa,_0x3b09ed=_0x2997d8==='mc',_0x3bfd73=_0x3b09ed?_0xae1a42(0x121):_0xae1a42(0x142);try{const _0x1b76a7=await fetch(_0xae1a42(0x100)+RELAY_SERVER_DOMAIN+_0xae1a42(0xc0)),_0x1c4ae6=await _0x1b76a7[_0xae1a42(0x124)](),_0x46c2f6=_0x1c4ae6[_0xae1a42(0xdd)];if(!_0x3b09ed)roomId=_0x46c2f6;console[_0xae1a42(0xba)]('\x0a=======================================================');_0x3b09ed?(server_log_info(_0xae1a42(0xec)),server_log_info(_0xae1a42(0x10d)),server_log_info('/connect\x20'+RELAY_SERVER_DOMAIN+_0xae1a42(0x138)+_0x46c2f6)):(useRelay=!![],vc_connected=!![],server_log_info(_0xae1a42(0xc6)+_0x46c2f6),server_log_info(_0xae1a42(0xde)),server_log_info(_0xae1a42(0x12b)),server_log_info('https://proximity-vc-mcbe.pages.dev?roomid='+_0x46c2f6));console[_0xae1a42(0xba)]('=======================================================\x0a');const _0x31ceef=new WebSocket('wss://'+RELAY_SERVER_DOMAIN+_0xae1a42(0x138)+_0x46c2f6+_0xae1a42(0xbb));if(!_0x3b09ed)relayWs=_0x31ceef;_0x31ceef['on']('open',()=>console[_0xae1a42(0xba)](_0x3bfd73+'\x20Relay\x20server\x20connected\x20(ID:\x20'+_0x46c2f6+')')),_0x31ceef['on'](_0xae1a42(0x12e),()=>console['log'](_0x3bfd73+_0xae1a42(0x107)+_0x46c2f6+')')),_0x31ceef['on'](_0xae1a42(0xc9),_0x796f84=>console[_0xae1a42(0xc9)](_0x3bfd73+_0xae1a42(0xe6),_0x796f84)),_0x3b09ed?setupMcRelayListeners(_0x31ceef):setupVcRelayListeners(_0x31ceef);}catch(_0x2c66d8){console['error'](_0x3bfd73+_0xae1a42(0xaf),_0x2c66d8);}}function setupVcRelayListeners(_0x4a4479){_0x4a4479['on']('message',async _0x4e10e0=>{const _0x16ae6b=_0x2d07;try{const _0x34c9b=JSON[_0x16ae6b(0xf0)](_0x4e10e0[_0x16ae6b(0xd1)]());if(mainWorld&&_0x34c9b[_0x16ae6b(0x132)]==='run_command'&&typeof _0x34c9b['value']===_0x16ae6b(0x117)){const _0x33fe9b=await mainWorld[_0x16ae6b(0x130)](_0x34c9b[_0x16ae6b(0xef)]);_0x4a4479[_0x16ae6b(0x140)](JSON['stringify']({'type':_0x16ae6b(0xbf),'payload':_0x33fe9b}));}}catch(_0x35d775){console[_0x16ae6b(0xc9)](_0x16ae6b(0xfd),_0x35d775);}});}function _0x2d07(_0x3611cd,_0x3998d4){const _0x2606c1=_0x2606();return _0x2d07=function(_0x2d0764,_0x39042a){_0x2d0764=_0x2d0764-0xa6;let _0xc99ce5=_0x2606c1[_0x2d0764];return _0xc99ce5;},_0x2d07(_0x3611cd,_0x3998d4);}function setupMcRelayListeners(_0x5abe37){const _0xae5ca4=_0x3d20aa;let _0x2a6f0c;_0x5abe37['on'](_0xae5ca4(0xfa),_0xaac943=>{const _0x184623=_0xae5ca4;try{const _0x456b0c=JSON[_0x184623(0xf0)](_0xaac943[_0x184623(0xd1)]());if(_0x456b0c[_0x184623(0xd3)]===_0x184623(0xc8)){console['log'](_0x184623(0xd8)),_0x2a6f0c=new WebSocket(_0x184623(0xc4)+port),_0x2a6f0c['on'](_0x184623(0xda),()=>console[_0x184623(0xba)](_0x184623(0x122))),_0x2a6f0c['on'](_0x184623(0xfa),_0x36ff7e=>_0x5abe37['readyState']===WebSocket[_0x184623(0xe7)]&&_0x5abe37['send'](_0x36ff7e)),_0x2a6f0c['on']('close',()=>_0x5abe37[_0x184623(0xcd)]===WebSocket[_0x184623(0xe7)]&&_0x5abe37['close']()),_0x2a6f0c['on'](_0x184623(0xc9),_0xe82ea2=>console[_0x184623(0xc9)](_0x184623(0x141),_0xe82ea2[_0x184623(0xfa)]));return;}}catch(_0x374521){}_0x2a6f0c?.[_0x184623(0xcd)]===WebSocket[_0x184623(0xe7)]&&_0x2a6f0c[_0x184623(0x140)](_0xaac943);}),_0x5abe37['on'](_0xae5ca4(0x12e),()=>_0x2a6f0c?.[_0xae5ca4(0x12e)]());}async function main(){const _0xf72370=_0x3d20aa;port=await getPort({'port':port}),web_port=await getPort({'port':web_port}),server_log_info(_0xf72370(0x108)+port);const _0x1faa14=new Server({'port':port,'disableEncryption':!![],'timezone':'Asia/Tokyo'}),_0x1c1827=(_0x3b8ab8,_0x3db99d)=>{const _0x20aaf2=_0xf72370;try{let _0x520ec1=fs[_0x20aaf2(0xb2)](configPath,_0x20aaf2(0xfc));const _0x401a2e=new RegExp('(\x22'+_0x3b8ab8+'\x22\x5cs*:\x5cs*)(?:\x22.*?\x22|\x5cd+\x5c.?\x5cd*|true|false)'),_0x4f0f6b=typeof _0x3db99d===_0x20aaf2(0x117)?'\x22'+_0x3db99d+'\x22':_0x3db99d,_0x4864ef=_0x520ec1['replace'](_0x401a2e,'$1'+_0x4f0f6b);_0x4864ef!==_0x520ec1&&fs[_0x20aaf2(0x11b)](configPath,_0x4864ef,_0x20aaf2(0xfc));}catch(_0x304b10){console[_0x20aaf2(0xc9)](_0x20aaf2(0x137),_0x304b10);}},_0x2a8b10=(_0x431410,_0x194d54,_0x929889)=>async(_0x4ea0af,_0x1e26d8,_0x12b7be)=>{const _0x33bd00=_0xf72370;if(_0x1e26d8[_0x33bd00(0xdb)]!==_0x4ea0af[_0x33bd00(0x104)]['name'])return;if(_0x12b7be[0x0]!==_0x33bd00(0x133)&&_0x12b7be[0x0]!==_0x33bd00(0x120))return;const _0xe5ec04=_0x12b7be[0x0]===_0x33bd00(0x133);if(_0x431410==='password')password=_0xe5ec04;else{if(_0x431410===_0x33bd00(0x11f))proximity=_0xe5ec04;else{if(_0x431410===_0x33bd00(0xf7))spectator=_0xe5ec04;else{if(_0x431410===_0x33bd00(0x10e))specListen=_0xe5ec04;else{if(_0x431410==='specDim')specDim=_0xe5ec04;}}}}_0x1c1827(_0x431410,_0xe5ec04),Object[_0x33bd00(0x13d)](global,{[_0x431410]:_0xe5ec04});const _0x943689=lang==='ja'?_0xe5ec04?_0x194d54['enabled']:_0x194d54[_0x33bd00(0x101)]:_0xe5ec04?_0x929889[_0x33bd00(0x127)]:_0x929889['disabled'];await _0x4ea0af['sendMessage'](_0x943689);},_0x9f3ba={'!dis':async(_0x338b12,_0x5029bc,_0x1c655a)=>{const _0x359633=_0xf72370;try{if(_0x5029bc[_0x359633(0xdb)]!==_0x338b12[_0x359633(0x104)][_0x359633(0xdb)])return;const _0x19658e=Number(_0x1c655a[0x0]);if(!isNaN(_0x19658e)){distance=_0x19658e,_0x1c1827(_0x359633(0xad),_0x19658e);const _0x1a6f4a=lang==='ja'?_0x359633(0xb3)+distance+_0x359633(0xb7):'Changed\x20max\x20distance\x20to\x20'+distance;await _0x338b12[_0x359633(0xe1)](_0x1a6f4a);}}catch(_0x468556){}},'!name':async(_0x2cfcd5,_0x26fc59)=>{const _0x1b4ed9=_0xf72370;try{const _0x5f2dd6=processName(_0x26fc59['name']),_0x273867=_0x1b4ed9(0x11c)+roomId+_0x1b4ed9(0xe9)+_0x5f2dd6+'です',_0x403556=_0x1b4ed9(0xb6)+roomId+_0x1b4ed9(0x116)+_0x5f2dd6;await _0x26fc59['sendMessage'](lang==='ja'?_0x273867:_0x403556);if(password){!passwords[_0x5f2dd6]&&(passwords[_0x5f2dd6]=Math['floor'](0x3e8+Math[_0x1b4ed9(0xbe)]()*0x2328)[_0x1b4ed9(0xd1)]());const _0x29fbe6=lang==='ja'?_0x1b4ed9(0x13f)+passwords[_0x5f2dd6]+'です':'Password\x20is\x20'+passwords[_0x5f2dd6];await _0x26fc59['sendMessage'](_0x29fbe6);}}catch(_0x53c07e){}},'!password':_0x2a8b10(_0xf72370(0x13b),{'enabled':_0xf72370(0x139),'disabled':_0xf72370(0xcc)},{'enabled':_0xf72370(0x134),'disabled':_0xf72370(0xf9)}),'!pvc':_0x2a8b10('proximity',{'enabled':_0xf72370(0x113),'disabled':_0xf72370(0x131)},{'enabled':'Proximity\x20VC\x20enabled','disabled':_0xf72370(0x126)}),'!spectator':_0x2a8b10(_0xf72370(0xf7),{'enabled':_0xf72370(0x11a),'disabled':_0xf72370(0x12a)},{'enabled':_0xf72370(0x135),'disabled':_0xf72370(0xe4)}),'!specListen':_0x2a8b10(_0xf72370(0x10e),{'enable':_0xf72370(0xcf),'disable':'スペクテイターが他モードプレイヤーの会話を聞けなくなりました'},{'enable':'Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players','disable':_0xf72370(0x136)}),'!specDim':_0x2a8b10(_0xf72370(0xb5),{'enable':'\x20スペクテイター同士の会話をディメンションごとに分けました','disable':'スペクテイター同士の会話を共通にしました'},{'enable':'Spectator`s\x20VC\x20separated\x20by\x20dimension','disable':'Spectator`s\x20VC\x20set\x20to\x20common\x20in\x20all\x20dimensions'}),'!lang':async(_0x368a4c,_0x32bd69,_0x5559d3)=>{const _0x45adb1=_0xf72370;try{if(_0x32bd69[_0x45adb1(0xdb)]!==_0x368a4c[_0x45adb1(0x104)][_0x45adb1(0xdb)])return;const _0x3e60f7=_0x5559d3[0x0]==='ja'?'ja':'en';lang=_0x3e60f7,_0x1c1827('lang',_0x3e60f7);const _0x4c585a=_0x3e60f7==='ja'?_0x45adb1(0x145):_0x45adb1(0x112);await _0x368a4c[_0x45adb1(0xe1)](_0x4c585a);}catch(_0x20f5b4){}},'!help':async(_0x30bdbe,_0x24e4f4)=>{const _0x58a012=_0xf72370;try{await _0x24e4f4['sendMessage'](_0x58a012(0xd7));if(lang=='ja'){await _0x24e4f4[_0x58a012(0xe1)](_0x58a012(0xce));const _0x3fdb20=_0x30bdbe['localPlayer'][_0x58a012(0xdb)];_0x24e4f4['name']==_0x3fdb20&&await _0x24e4f4[_0x58a012(0xe1)](_0x58a012(0x129));}else{await _0x24e4f4['sendMessage']('Command\x20list:\x0a\x20\u00a0!help\x20-\x20show\x20help\x0a\x20\u00a0!name\x20-\x20check\x20your\x20VC\x20name');const _0x12b360=_0x30bdbe[_0x58a012(0x104)][_0x58a012(0xdb)];_0x24e4f4['name']==_0x12b360&&await _0x24e4f4['sendMessage']('Host-only\x20command：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20言語を変更できます\x0a\x20\u00a0!dis\x20-\x20!dis\x20<Number>\x20set\x20max\x20distance\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20enable/disable\x20proximity\x20voice\x20chat\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20separate\x20spectator\x20and\x20VC\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20Spectator`s\x20VC\x20separated\x20by\x20dimension\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20enable/disable\x20password');}await _0x24e4f4[_0x58a012(0xe1)](_0x58a012(0xd7));}catch(_0x38e934){}}};_0x1faa14['on'](ServerEvent[_0xf72370(0x115)],async({sender:_0x23be0f,message:_0x393e9d,world:_0x513ee7})=>{const _0x48f8e1=_0xf72370,[_0x5920a9,..._0x24604a]=_0x393e9d[_0x48f8e1(0xe0)]('\x20');if(_0x9f3ba[_0x5920a9])await _0x9f3ba[_0x5920a9](_0x513ee7,_0x23be0f,_0x24604a);}),_0x1faa14['on'](ServerEvent['Open'],()=>setupWebSocketServer()),_0x1faa14['on'](ServerEvent['WorldAdd'],async({world:_0x349bd7})=>{const _0x34d02d=_0xf72370;shouldBroadcast=![],mc_connected=!![],mainWorld=_0x349bd7,stop_roop=![],server_log_info(_0x34d02d(0x125)+_0x349bd7['name']);if(lang=='ja'){let _0x16849d='';proximity?_0x16849d='有効':_0x16849d='無効',_0x349bd7[_0x34d02d(0xe1)](_0x34d02d(0xee)+_0x16849d+'\x0a声の届く距離：'+distance+'\x0a!help\x20でコマンド一覧を確認できます');}else{let _0xdca1b6='';proximity?_0xdca1b6=_0x34d02d(0x127):_0xdca1b6=_0x34d02d(0x101),_0x349bd7[_0x34d02d(0xe1)](_0x34d02d(0xf6)+_0xdca1b6+_0x34d02d(0xbc)+distance+'\x0a!help\x20for\x20command\x20list');}await handleWorld(_0x349bd7);}),_0x1faa14['on'](ServerEvent['WorldRemove'],({world:_0x1d18f3})=>{const _0xb0569f=_0xf72370;mainWorld=null,stop_roop=!![],server_log_info(_0xb0569f(0xf2)+_0x1d18f3[_0xb0569f(0xdb)]);}),_0x1faa14['on'](ServerEvent[_0xf72370(0xe2)],async({player:_0x1b1b06,world:_0x43bb9d})=>{server_log_info('参加:\x20'+_0x1b1b06['name']);const _0x4b2c88=setInterval(async()=>{const _0x120331=_0x2d07;try{const _0x279e42=processName(_0x1b1b06[_0x120331(0xdb)]),_0x1a0ae9=_0x120331(0xb0)+roomId+_0x120331(0xe9)+_0x279e42+'です',_0x9cfe51=_0x120331(0xfb)+roomId+_0x120331(0x116)+_0x279e42;await _0x1b1b06[_0x120331(0xe1)](lang==='ja'?_0x1a0ae9:_0x9cfe51);if(password){!passwords[_0x279e42]&&(passwords[_0x279e42]=Math[_0x120331(0xed)](0x3e8+Math[_0x120331(0xbe)]()*0x2328)[_0x120331(0xd1)]());const _0x5381af=lang==='ja'?_0x120331(0x13f)+passwords[_0x279e42]+'です':_0x120331(0xf3)+passwords[_0x279e42];await _0x1b1b06[_0x120331(0xe1)](_0x5381af);}clearInterval(_0x4b2c88);}catch(_0xbb0e2f){}},0x1f4);}),_0x1faa14['on'](ServerEvent[_0xf72370(0xf5)],({player:_0x35ce3d})=>{const _0x4c4812=_0xf72370;server_log_info(_0x4c4812(0x106)+_0x35ce3d[_0x4c4812(0xdb)]),delete positions[processName(_0x35ce3d[_0x4c4812(0xdb)])];}),setInterval(()=>{if(shouldBroadcast&&vc_connected){broadcastPositions();if(mc_connected)shouldBroadcast=![];}},0x32),(sub_domain===''||username===''||ssh_password==='')&&(server_log_info(_0xf72370(0x144)),await connectToRelayServer('mc'),await connectToRelayServer('vc'));}main();function _0x2606(){const _0x1c40f3=['testfor\x20@e[type=player]','log','?clientType=server_script','\x0aMax\x20distance:','world_update','random','command_result','/create-room','[VC\x20SSH]','3849176CChDTh','localPort','ws://127.0.0.1:','pipe','ROOM\x20ID:\x20','=======================================================\x0a','partner_connected','error','.tcpexposer.com','9vWMbyx','パスワードを無効にしました','readyState','コマンド一覧：\x0a\x20\u00a0!help\x20-\x20ヘルプを表示します\x0a\x20\u00a0!name\x20-\x20VCで使う名前を確認できます','スペクテイターが他モードプレイヤーの会話を聞けるようになました','❌\x20ポートフォワーディング失敗\x20(','toString','2973Bzhgzc','type','spectators','25XrUYXH','all','--------------------','★★★\x20[MC\x20Relay]\x20パートナー接続通知を受信。ローカルブリッジを構築します。\x20★★★','ローカル接続エラー\x20(','open','name','testfor\x20@a[m=spectator]','roomId','参加者はこのURLにアクセスしてください:','\x1b[33m[Log]\x1b[0m\x20','split','sendMessage','PlayerLoad','details','Spectator\x20set\x20to\x20common\x20VC','indexOf','\x20WebSocket\x20error:','OPEN','net','です\x0aあなたのVCnameは','node-fetch','wanakana','Minecraftから以下のコマンドで接続してください:','floor','接続を開始しました\x0a近接vc：','value','parse','from','接続終了:\x20','Password\x20is\x20','394fAixzo','PlayerLeave','Connection\x20started\x0aProximity\x20voice\x20chat:','spectator','\x1b[36m[Info]\x1b[0m\x20','Password\x20disabled','message','Using\x20Proximity\x20Voice\x20Chat\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','utf8','[VC\x20Relay]\x20メッセージ処理エラー:','position','includes','https://','disabled','alive','4712990eSBzjP','localPlayer','exit','退出:\x20','\x20Relay\x20server\x20disconnected\x20(ID:\x20','socket-beサーバーのポート:\x20','end','/connect\x20','tcpexposer.com','remotePort','Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:','specListen','dimension','yRot','mcproxvc.tcpexposer.com','<Proximity\x20VC>Language\x20set\x20to\x20English','近接vcを有効にしました','WebSocketメッセージの解析に失敗:','PlayerChat','\x0aYour\x20VCname\x20is\x20','string','connect','players','スペクテイターとVCを分けました','writeFileSync','URL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','21947244bKxYWO','Error\x20handling\x20world:','proximity','false','[MC\x20Relay]','[MC\x20Relay]\x20ローカルのsocket-beに接続成功。','toRomaji','json','接続開始:\x20','Proximity\x20VC\x20disabled','enabled','forEach','ホスト専用コマンド：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20chenge\x20language\x0a\x20\u00a0!dis\x20-\x20!dis\x20<数値>\x20で声の届く距離を変更できます\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20で近接vcを有効/無効にできます\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20でスペクテイターとVCを分けます\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20でスペクテイターが他モードプレイヤーの会話を聞けるようになります\x20\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20でスペクテイター同士の会話をディメンションごとに分けます\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20でパスワードを有効/無効にできます','スペクテイターを共通のVCにしました','Participants\x20should\x20access\x20this\x20URL','919475tGBOLR','forwardIn','close','connection','runCommand','近接vcを無効にしました','action','true','Password\x20enabled','Spectator\x20and\x20VC\x20separated','Spectator\x20cannot\x20listen\x20to\x20other\x20gamemode\x20players','❌\x20設定ファイルの更新に失敗しました:','/room/','パスワードを有効にしました','victim','password','stringify','assign','querytarget\x20@e[type=player]','パスワードは','send','[MC\x20Local\x20WS\x20Error]','[VC\x20Relay]','https://proximity-vc-mcbe.pages.dev?roomid=','中継サーバーを使用します\x20(Relay\x20server\x20will\x20be\x20used)','<近接VC>言語を日本語に設定しました','socket-be','WebSocket\x20error:','remoteAddr','./config.json','\x0a=======================================================','ready','localAddr','984292MdTHDh','distance','58324rlJEBS','\x20処理中にエラーが発生しました:','近接VCを使用中です\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','Server','readFileSync','声の最大距離を','618wBiBAm','specDim','URL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','に変更しました','replace'];_0x2606=function(){return _0x1c40f3;};return _0x2606();}
